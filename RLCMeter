RLCMeter

Измеряем напряжение на элементе и ток на сопротивлении которое последовательно с ним стоит.

R = 1/(2*PI*F*C)
R = (2*PI*F*L)

import math
def RFC(F,C): return 1/(2*math.pi*F*C)
def RFL(F,L): return 2*math.pi*F*L

F = 50 kHz
C = 1 mkF R = 3 Om
C = 1 nF R = 3 KOm
C = 1 pF R = 3 MOm

L = 1 mH R = 3 Om
L = 1 mkH R = 0.3 Om
L = 1 nH R = 0.3 mOm

F = 100 Hz
C = 1000 mkF R = 1.6 Om
C = 100 mkF R = 16 Om

L = 1 KH R = 628 KOm
L = 1 H R = 628 Om
L = 1 mH R = 0.6 Om

Теперь прикинем напряжение, какое можем измерять.
3.3 V напряжение измеряемое ADC
Максимальный коэффициэнт усиления 32
0.1 V при максимальном коэффициэнте
10 mA максимальный ток

100 Om == 0.1 V

Значит предусилитель x10 обязательно нужен.

Возможно лучше таки сделать "инструментальный" вариант, где резисторы переключаются с использованием реле.
74HC4052 c 100 ом проходного сопротивления - это всетаки несколько экстремально.
Это конечно несколько экстенсивно, зато позволит достаточно точно контролировать емкость параллельную сопротивлению.

Перед выходным усилителем таки сделать гальваническую развязку, это позволит избавиться от цепи подгонки постоянной составляющей напряжения.
Гальваническая развязка это не очень хорошо, потому как если будем измерять большое сопротивление, то постоянная составляющая долго может устаканиваться.

По выводам
74HC4052 == 4052
AD8532 == LM358

----------------------------
Пусть резисторы переключаются посредством 74HC4052, это экономично и мало места займет.
Пусть вход инструментального усилителя переключается посредством реле. Возьмем реле с двумя группами контактов.

Питать будем пока от USB, а в дальнейшем от батареек 6 V.
AD8532 - используем как обычные ОУ
AD8221 - инструментальный усилитель, пускай всегда усиливает в 1 и 20 раз.
MCP6S21 - усилитель с программируемым коэффициэнтом усиления 1..32 раза.

300 mV напряжение на выходе усилителей.

---------------------------
- нарисовать схему где есть два инструментальных усилителя для измерения тока и напряжения
- поставить дырки, чтобы подцепляться осциллографом

----------------------------
Перерисовал схему.

Воспользовался OP07C в качестве усилителя с низким Input Offset Voltage. В буфере/фильтре на выходе генератора частоты. И в "виртуальной земле" на 2.5 V.

Фильтр, который фильтрует DAC оставил того-же третьего порядка. Вроде должно хватать. Если учесть что будем на частоте 1 MHz сигнал генерировать, то там более чем достаточное подавление получается.

Инструментальные усилители все время работают с Ку=10 примерно. Все равно надо усиливать сигнал с 300 мВ до 3 В. Надеемся, что не будет между двумя ADC проникновения сигнала взаимного.

В генераторе тока применил AD825R микросхемку (она не работает от 5 V однополярного)


